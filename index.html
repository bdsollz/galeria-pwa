<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Minha Galeria</title>
<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#121212">
<link rel="apple-touch-icon" href="icons/icon-192.png">

<style>
body{
  margin:0;
  font-family:sans-serif;
  background:#121212;
  color:white;
  padding:20px;
}
h1{margin:0 0 20px 0}
.topbar{display:flex;gap:10px;margin-bottom:20px}
button{cursor:pointer}
.grid{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:12px;
}
.card{
  position:relative;
  aspect-ratio:9/14;
  overflow:hidden;
  border-radius:12px;
  background:#2c2c2c;
}
.card img{
  width:100%;
  height:100%;
  object-fit:cover;
}
.card-content{
  position:absolute;
  bottom:0;
  width:100%;
  background:linear-gradient(to top,rgba(0,0,0,.8),transparent);
  padding:10px;
}
.delete-btn{
  position:absolute;
  top:8px;
  right:8px;
  width:28px;
  height:28px;
  border:none;
  border-radius:50%;
  background:rgba(0,0,0,.6);
  color:white;
}
.move-btn{
  position:absolute;
  left:8px;
  width:28px;
  height:28px;
  border:none;
  border-radius:50%;
  background:rgba(0,0,0,.6);
  color:white;
}
.move-up{top:8px}
.move-down{top:42px}
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.8);
  justify-content:center;
  align-items:center;
}
.modal-content{
  background:#1e1e1e;
  padding:20px;
  border-radius:12px;
  width:300px;
}
input{
  width:100%;
  margin:10px 0;
  padding:8px;
}
</style>
</head>

<body>

<h1>Minha Galeria</h1>

<div class="topbar">
  <button id="organizeBtn">Organizar</button>
  <button id="openModalBtn">Adicionar</button>
</div>

<div class="grid" id="peopleGrid"></div>

<div class="modal" id="modal">
  <div class="modal-content">
    <h3 id="modalTitle">Nova Pessoa</h3>
    <input type="file" id="photoInput">
    <input type="text" id="nameInput" placeholder="Nome">
    <input type="text" id="referenceInput" placeholder="Referência">
    <button id="saveBtn">Salvar</button>
    <button id="cancelBtn">Cancelar</button>
  </div>
</div>

<script>
const STORAGE_KEY="galeria";
let people=JSON.parse(localStorage.getItem(STORAGE_KEY))||[];
let editingIndex=null;
let organizeMode=false;

const grid=document.getElementById("peopleGrid");
const modal=document.getElementById("modal");
const openModalBtn=document.getElementById("openModalBtn");
const saveBtn=document.getElementById("saveBtn");
const cancelBtn=document.getElementById("cancelBtn");
const nameInput=document.getElementById("nameInput");
const referenceInput=document.getElementById("referenceInput");
const photoInput=document.getElementById("photoInput");
const organizeBtn=document.getElementById("organizeBtn");
const modalTitle=document.getElementById("modalTitle");

function saveStorage(){
 localStorage.setItem(STORAGE_KEY,JSON.stringify(people));
}

function render(){
 grid.innerHTML="";
 people.forEach((p,i)=>{
   const card=document.createElement("div");
   card.className="card";

   const img=document.createElement("img");
   img.src=p.photo;
   card.appendChild(img);

   const content=document.createElement("div");
   content.className="card-content";
   content.innerHTML=`<strong>${p.name}</strong><br>${p.reference||""}`;
   card.appendChild(content);

   const del=document.createElement("button");
   del.className="delete-btn";
   del.textContent="✕";
   del.onclick=()=>{
     if(confirm("Remover?")){
       people.splice(i,1);
       saveStorage();
       render();
     }
   };
   card.appendChild(del);

   if(organizeMode){
     const up=document.createElement("button");
     up.className="move-btn move-up";
     up.textContent="↑";
     up.onclick=()=>{
       if(i>0){
         [people[i-1],people[i]]=[people[i],people[i-1]];
         saveStorage();
         render();
       }
     };

     const down=document.createElement("button");
     down.className="move-btn move-down";
     down.textContent="↓";
     down.onclick=()=>{
       if(i<people.length-1){
         [people[i+1],people[i]]=[people[i],people[i+1]];
         saveStorage();
         render();
       }
     };

     card.appendChild(up);
     card.appendChild(down);
   }else{
     card.onclick=()=>{
       editingIndex=i;
       nameInput.value=p.name;
       referenceInput.value=p.reference||"";
       photoInput.value="";
       modalTitle.textContent="Editar Pessoa";
       modal.style.display="flex";
     };
   }

   grid.appendChild(card);
 });
}

openModalBtn.onclick=()=>{
 editingIndex=null;
 nameInput.value="";
 referenceInput.value="";
 photoInput.value="";
 modalTitle.textContent="Nova Pessoa";
 modal.style.display="flex";
};

cancelBtn.onclick=()=>modal.style.display="none";

saveBtn.onclick=()=>{
 const name=nameInput.value.trim();
 const reference=referenceInput.value.trim();
 if(!name){alert("Digite o nome");return;}

 if(editingIndex===null){
   if(!photoInput.files.length){alert("Escolha uma foto");return;}
   const reader=new FileReader();
   reader.onload=()=>{
     people.push({name,reference,photo:reader.result});
     saveStorage();
     render();
     modal.style.display="none";
   };
   reader.readAsDataURL(photoInput.files[0]);
 }else{
   const person=people[editingIndex];
   person.name=name;
   person.reference=reference;
   if(photoInput.files.length){
     const reader=new FileReader();
     reader.onload=()=>{
       person.photo=reader.result;
       saveStorage();
       render();
       modal.style.display="none";
     };
     reader.readAsDataURL(photoInput.files[0]);
   }else{
     saveStorage();
     render();
     modal.style.display="none";
   }
 }
};

organizeBtn.onclick=()=>{
 organizeMode=!organizeMode;
 organizeBtn.textContent=organizeMode?"Concluir":"Organizar";
 render();
};

render();
</script>

</body>
</html>


